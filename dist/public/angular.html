<!doctype html>
<html ng-app="magicpro" >
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.3/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.3/angular-resource.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.3/angular-route.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.5.2/underscore-min.js"></script>
  </head>
  <body>
    <div ng-controller="Shop">
          <div ng-view ></div>

    </div>
  </body>

  <script>

  angular.module("magicpro", ["ngResource", 'ngRoute' ])
  .config(function($routeProvider) {
          $routeProvider.when('/:category', {
              // alert("test");
              controller: "Types",
              templateUrl: 'views/types.html'
          }).when("/", {
              controller: "Categories",
              templateUrl: 'views/categories.html'
          });
        }
  )
.controller("Shop", function($scope, $resource, $location){
})
.controller("Categories", function($scope, $resource, $location){
    var Category = $resource("api/categories");

    $scope.categories = Category.query();


})
.controller("Types", function($scope, $resource, $location, $routeParams){
    var Category = $resource("api/categories");

    $scope.categories = Category.query(function(){
      $scope.category = _.findWhere($scope.categories, {slug: $routeParams.category});      
    });    
    
});



  

  </script>

</html>